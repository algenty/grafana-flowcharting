(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1366:function(e,t,n){"use strict";var a=n(2),r=n(0),s=n.n(r),o=function(e){function t(t){var n=e.call(this,t)||this;return n.state={error:null,errorInfo:null},n}return a.c(t,e),t.prototype.componentDidCatch=function(e,t){this.setState({error:e,errorInfo:t})},t.prototype.render=function(){return this.state.errorInfo?s.a.createElement("div",{className:"explore-container"},s.a.createElement("h3",null,"An unexpected error happened."),s.a.createElement("details",{style:{whiteSpace:"pre-wrap"}},this.state.error&&this.state.error.toString(),s.a.createElement("br",null),this.state.errorInfo.componentStack)):this.props.children},t}(r.Component);t.a=o},1367:function(e,t,n){"use strict";var a=n(2),r=n(7),s=n.n(r),o=n(0),i=n.n(o),l=n(4),c=n.n(l),u=n(167),p=(n(148),n(263),n(354),n(355),n(27)),m=function(e){var t=e.series;return i.a.createElement("div",{className:"graph-legend-series"},i.a.createElement("div",{className:"graph-legend-icon"},i.a.createElement("i",{className:"fa fa-minus pointer",style:{color:t.color}})),i.a.createElement("a",{className:"graph-legend-alias pointer",title:t.alias},t.alias))},h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,a=e.data||[];return i.a.createElement("div",{className:n+" graph-legend ps"},a.map(function(e){return i.a.createElement(m,{key:e.id,series:e})}))},t}(o.PureComponent);var d={legend:{show:!1},series:{lines:{linewidth:1,zero:!1},shadowSize:0},grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0},selection:{mode:"x",color:"#666"}},f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={showAllTimeSeries:!1},t.onPlotSelected=function(e,n){if(t.props.onChangeTime){var a={from:c()(n.xaxis.from),to:c()(n.xaxis.to)};t.props.onChangeTime(a)}},t.onShowAllTimeSeries=function(){t.setState({showAllTimeSeries:!0},t.draw)},t}return a.c(t,e),t.prototype.getGraphData=function(){var e=this.props.data;return this.state.showAllTimeSeries?e:e.slice(0,20)},t.prototype.componentDidMount=function(){this.draw(),this.$el=s()("#"+this.props.id),this.$el.bind("plotselected",this.onPlotSelected)},t.prototype.componentDidUpdate=function(e){(e.data!==this.props.data||e.range!==this.props.range||e.split!==this.props.split||e.height!==this.props.height||e.size&&e.size.width!==this.props.size.width)&&this.draw()},t.prototype.componentWillUnmount=function(){this.$el.unbind("plotselected",this.onPlotSelected)},t.prototype.draw=function(){var e=this.props,t=e.range,n=e.size,r=e.userOptions,o=void 0===r?{}:r,i=this.getGraphData(),l=s()("#"+this.props.id),u=[{data:[[0,0]]}];i&&i.length>0&&(u=i.map(function(e){return{color:e.color,label:e.label,data:e.getFlotPairs("null")}}));var m=(n.width||0)/100,h=t.from,f=t.to;c.a.isMoment(h)||(h=p.parse(h,!1)),c.a.isMoment(f)||(f=p.parse(f,!0));var g=h.valueOf(),v=f.valueOf(),y={xaxis:{mode:"time",min:g,max:v,label:"Datetime",ticks:m,timezone:"browser",timeformat:function(e,t,n){if(t&&n&&e){var a=n-t,r=a/e/1e3;return r<=45?"%H:%M:%S":r<=7200||a<=864e5?"%H:%M":r<=8e4?"%m/%d %H:%M":r<=2419200||a<=31536e6?"%m/%d":"%Y-%m"}return"%H:%M"}(m,g,v)}},b=a.a({},d,y,o);s.a.plot(l,u,b)},t.prototype.render=function(){var e=this.props,t=e.height,n=void 0===t?"100px":t,a=e.id,r=void 0===a?"graph":a,s=this.getGraphData();return i.a.createElement(i.a.Fragment,null,this.props.data&&this.props.data.length>20&&!this.state.showAllTimeSeries&&i.a.createElement("div",{className:"time-series-disclaimer"},i.a.createElement("i",{className:"fa fa-fw fa-warning disclaimer-icon"}),"Showing only 20 time series. ",i.a.createElement("span",{className:"show-all-time-series",onClick:this.onShowAllTimeSeries},"Show all "+this.props.data.length)),i.a.createElement("div",{id:r,className:"explore-graph",style:{height:n}}),i.a.createElement(h,{data:s}))},t}(o.PureComponent);t.a=Object(u.withSize)()(f)},1368:function(e,t,n){"use strict";(function(e){var a=n(2),r=n(0),s=n.n(r),o=n(35),i=n(61),l=n(1),c=n.n(l),u=n(12),p=n(31),m=n(40),h=n(63),d=n(27),f=n(210),g=n(97),v=n(240),y=n(112),b=n(113),E=n(73),w=n(1369),C=n(1373),S=n(1367),x=n(1374),T=n(1370),k=n(1366),N=n(1371),q=n(1372),O=100;function Q(e,t,n){if(!t||!n)return{interval:"1s",intervalMs:1e3};var a={from:Object(d.parse)(e.from,!1),to:Object(d.parse)(e.to,!0)};return u.a.calculateInterval(a,n,t.interval)}var R=function(e){function t(t){var n=e.call(this,t)||this;n.getRef=function(e){n.el=e},n.onAddQueryRow=function(e){n.queryExpressions[e+1]="",n.setState(function(t){var n=t.queries,r=t.queryTransactions;return{queries:n.slice(0,e+1).concat([{query:"",key:Object(q.b)()}],n.slice(e+1)),queryTransactions:r.map(function(t){return t.rowIndex>e?a.a({},t,{rowIndex:t.rowIndex+1}):t})}})},n.onChangeDatasource=function(e){return a.b(n,void 0,void 0,function(){var t,n,r;return a.d(this,function(a){switch(a.label){case 0:return t=this.state.datasource,this.setState({datasource:null,datasourceError:null,datasourceLoading:!0,queryTransactions:[]}),n=e.value,[4,this.props.datasourceSrv.get(n)];case 1:return r=a.sent(),this.setDatasource(r,t),[2]}})})},n.onChangeQuery=function(e,t,a){n.queryExpressions[t]=e,a&&n.setState(function(n){var a=n.queries,r=n.queryTransactions,s={key:Object(q.b)(t),query:e},o=a.slice();return o[t]=s,{queries:o,queryTransactions:r.filter(function(e){return e.rowIndex!==t})}},n.onSubmit)},n.onChangeTime=function(e){var t=a.a({},e);n.setState({range:t},function(){return n.onSubmit()})},n.onClickClear=function(){n.queryExpressions=[""],n.setState(function(e){return{queries:Object(q.a)(),queryTransactions:[],showingStartPage:Boolean(e.StartPage)}},n.saveState)},n.onClickCloseSplit=function(){var e=n.props.onChangeSplit;e&&e(!1)},n.onClickGraphButton=function(){n.setState(function(e){var t=!e.showingGraph,n=e.queryTransactions;return t||(n=e.queryTransactions.filter(function(e){return"Graph"!==e.resultType})),{queryTransactions:n,showingGraph:t}},function(){n.state.showingGraph&&n.onSubmit()})},n.onClickLogsButton=function(){n.setState(function(e){var t=!e.showingLogs,n=e.queryTransactions;return t||(n=e.queryTransactions.filter(function(e){return"Logs"!==e.resultType})),{queryTransactions:n,showingLogs:t}},function(){n.state.showingLogs&&n.onSubmit()})},n.onClickQuery=function(e){var t=[{query:e,key:Object(q.b)()}];n.queryExpressions=t.map(function(e){return e.query}),n.setState({queries:t},n.onSubmit)},n.onClickSplit=function(){var e=n.props.onChangeSplit;e&&e(!0,n.cloneState())},n.onClickTableButton=function(){n.setState(function(e){var t=!e.showingTable,n=e.queryTransactions;return t||(n=e.queryTransactions.filter(function(e){return"Table"!==e.resultType})),{queryTransactions:n,showingTable:t}},function(){n.state.showingTable&&n.onSubmit()})},n.onClickTableCell=function(e,t){n.onModifyQueries({type:"ADD_FILTER",key:e,value:t})},n.onModifyQueries=function(e,t){var a=n.state.datasource;if(a&&a.modifyQuery){var r=e.preventSubmit;n.setState(function(s){var o,i,l=s.queries,c=s.queryTransactions;return void 0===t?(o=l.map(function(t,r){return{key:Object(q.b)(r),query:a.modifyQuery(n.queryExpressions[r],e)}}),i=[]):(o=l.map(function(r,s){return r.query=n.queryExpressions[s],s===t?{key:Object(q.b)(t),query:a.modifyQuery(r.query,e)}:r}),i=c.map(function(n){return null!=n.hints&&n.rowIndex===t&&(n.hints=n.hints.filter(function(t){return t.fix.action!==e})),n}).filter(function(e){return r||e.rowIndex!==t})),n.queryExpressions=o.map(function(e){return e.query}),{queries:o,queryTransactions:i}},r?null:function(){return n.onSubmit()})}},n.onRemoveQueryRow=function(e){n.queryExpressions=n.queryExpressions.slice(0,e).concat(n.queryExpressions.slice(e+1)),n.setState(function(t){var n=t.queries,a=t.queryTransactions;return n.length<=1?null:{queries:n.slice(0,e).concat(n.slice(e+1)),queryTransactions:a.filter(function(t){return t.rowIndex!==e})}},function(){return n.onSubmit()})},n.onSubmit=function(){var e=n.state,t=e.showingLogs,a=e.showingGraph,r=e.showingTable,s=e.supportsGraph,o=e.supportsLogs,i=e.supportsTable;r&&i&&n.runTableQuery(),a&&s&&n.runGraphQueries(),t&&o&&n.runLogsQuery(),n.saveState()},n.saveState=function(){var e=n.props,t=e.stateKey;(0,e.onSaveState)(t,n.cloneState())};var r,s=t.splitState;if(s)n.state=s,r=s.queries;else{var o=t.urlState,i=o.datasource,l=o.queries,c=o.range;r=Object(q.a)(l);var u=c||a.a({},f.a);n.state={datasource:null,datasourceError:null,datasourceLoading:null,datasourceMissing:!1,datasourceName:i,exploreDatasources:[],graphRange:u,history:[],queries:r,queryTransactions:[],range:u,showingGraph:!0,showingLogs:!0,showingStartPage:!1,showingTable:!0,supportsGraph:null,supportsLogs:null,supportsTable:null}}return n.queryExpressions=r.map(function(e){return e.query}),n}return a.c(t,e),t.prototype.componentDidMount=function(){return a.b(this,void 0,void 0,function(){var e,t,n,r,s;return a.d(this,function(a){switch(a.label){case 0:if(e=this.props.datasourceSrv,t=this.state.datasourceName,!e)throw new Error("No datasource service passed as props.");return n=e.getExploreSources(),r=n.map(function(e){return{value:e.name,label:e.name}}),n.length>0?(this.setState({datasourceLoading:!0,exploreDatasources:r}),s=void 0,t?[4,e.get(t)]:[3,2]):[3,8];case 1:return s=a.sent(),[3,4];case 2:return[4,e.get()];case 3:s=a.sent(),a.label=4;case 4:return s.meta.explore?[3,6]:[4,e.get(n[0].name)];case 5:s=a.sent(),a.label=6;case 6:return[4,this.setDatasource(s)];case 7:return a.sent(),[3,9];case 8:this.setState({datasourceMissing:!0}),a.label=9;case 9:return[2]}})})},t.prototype.setDatasource=function(e,t){return a.b(this,void 0,void 0,function(){var n,r,s,o,i,l,c,u,p,h,d,f,g,v,y=this;return a.d(this,function(b){switch(b.label){case 0:n=e.meta.metrics,r=e.meta.logs,s=e.meta.metrics,o=e.meta.id,i=null,this.requestedDatasourceId=o,b.label=1;case 1:return b.trys.push([1,3,,4]),[4,e.testDatasource()];case 2:return l=b.sent(),i="success"===l.status?null:l.message,[3,4];case 3:return c=b.sent(),i=c&&c.statusText||"Network error",[3,4];case 4:return o!==this.requestedDatasourceId?[2]:(u="grafana.explore.history."+o,p=m.a.getObject(u,[]),e.init&&e.init(),h=this.queryExpressions,t?t.meta.id!==e.meta.id?[3,5]:(h=this.queryExpressions.slice(),[3,8]):[3,8]);case 5:return e.importQueries?(d=this.queryExpressions.map(function(e,t){return{refId:String(t),expr:e}}),[4,e.importQueries(d,t.meta)]):[3,7];case 6:return f=b.sent(),h=f.map(function(e){return e.expr}),[3,8];case 7:h=this.queryExpressions.map(function(){return""}),b.label=8;case 8:return g=this.state.queries.map(function(e,t){return a.a({},e,{key:Object(q.b)(t),query:h[t]})}),this.queryExpressions=h,v=e.pluginExports.ExploreStartPage,this.setState({StartPage:v,datasource:e,datasourceError:i,history:p,supportsGraph:n,supportsLogs:r,supportsTable:s,datasourceLoading:!1,datasourceName:e.name,queries:g,showingStartPage:Boolean(v)},function(){null===i&&y.onSubmit()}),[2]}})})},t.prototype.buildQueryOptions=function(e,t,n){var r=this.state,s=r.datasource,o=r.range,i=Q(o,s,this.el.offsetWidth);return{interval:i.interval,intervalMs:i.intervalMs,targets:[a.a({},n,{refId:t+1,expr:e})],range:a.a({},o)}},t.prototype.startQueryTransaction=function(e,t,n,a){var r=this.buildQueryOptions(e,t,a),s={query:e,resultType:n,rowIndex:t,id:Object(q.b)(),done:!1,latency:0,options:r};return this.setState(function(e){return{queryTransactions:e.queryTransactions.filter(function(e){return!(e.resultType===n&&e.rowIndex===t)}).concat([s]),showingStartPage:!1}}),s},t.prototype.completeQueryTransaction=function(e,t,n,r,s){var o=this.state.datasource;o.meta.id===s&&this.setState(function(i){var l,c=i.history,u=i.queryTransactions,p=u.find(function(t){return t.id===e});if(!p)return null;o.getQueryHints&&(l=o.getQueryHints(p.query,t));var h=u.map(function(r){return r.id===e?a.a({},r,{hints:l,latency:n,result:t,done:!0}):r});return{history:function(e,t,n){var a=Date.now();n.forEach(function(t){e=[{query:t,ts:a}].concat(e)}),e.length>O&&(e=e.slice(0,O));var r="grafana.explore.history."+t;return m.a.setObject(r,e),e}(c,s,r),queryTransactions:h}})},t.prototype.discardTransactions=function(e){this.setState(function(t){return{queryTransactions:t.queryTransactions.filter(function(t){return t.rowIndex!==e})}})},t.prototype.failQueryTransaction=function(e,t,n){if(this.state.datasource.meta.id===n){console.error(t);var r=t;t.data&&(r=t.data.error,t.data.response&&(r=s.a.createElement(s.a.Fragment,null,s.a.createElement("span",null,t.data.error),s.a.createElement("details",null,t.data.response)))),this.setState(function(t){return t.queryTransactions.find(function(t){return t.id===e})?{queryTransactions:t.queryTransactions.map(function(t){return t.id===e?a.a({},t,{error:r,done:!0}):t})}:null})}},t.prototype.runGraphQueries=function(){return a.b(this,void 0,void 0,function(){var e,t,n,r=this;return a.d(this,function(s){return e=this.queryExpressions.slice(),Object(q.c)(e)?(t=this.state.datasource,n=t.meta.id,e.forEach(function(s,o){return a.b(r,void 0,void 0,function(){var r,i,l,c,u,m;return a.d(this,function(a){switch(a.label){case 0:if(!s)return[3,5];r=this.startQueryTransaction(s,o,"Graph",{format:"time_series",instant:!1}),a.label=1;case 1:return a.trys.push([1,3,,4]),i=Date.now(),[4,t.query(r.options)];case 2:return l=a.sent(),c=Date.now()-i,u=function(e,t){return e.map(function(e,t){var n=e.datapoints||[],a=e.target,r=t%p.g.length,s=p.g[r];return new h.a({datapoints:n,alias:a,color:s,unit:e.unit})})}(l.data,r.options),this.completeQueryTransaction(r.id,u,c,e,n),this.setState({graphRange:r.options.range}),[3,4];case 3:return m=a.sent(),this.failQueryTransaction(r.id,m,n),[3,4];case 4:return[3,6];case 5:this.discardTransactions(o),a.label=6;case 6:return[2]}})})}),[2]):[2]})})},t.prototype.runTableQuery=function(){return a.b(this,void 0,void 0,function(){var e,t,n,r=this;return a.d(this,function(s){return e=this.queryExpressions.slice(),Object(q.c)(e)?(t=this.state.datasource,n=t.meta.id,e.forEach(function(s,o){return a.b(r,void 0,void 0,function(){var r,i,l,c,u,p;return a.d(this,function(a){switch(a.label){case 0:if(!s)return[3,5];r=this.startQueryTransaction(s,o,"Table",{format:"table",instant:!0,valueWithRefId:!0}),a.label=1;case 1:return a.trys.push([1,3,,4]),i=Date.now(),[4,t.query(r.options)];case 2:return l=a.sent(),c=Date.now()-i,u=l.data[0],this.completeQueryTransaction(r.id,u,c,e,n),[3,4];case 3:return p=a.sent(),this.failQueryTransaction(r.id,p,n),[3,4];case 4:return[3,6];case 5:this.discardTransactions(o),a.label=6;case 6:return[2]}})})}),[2]):[2]})})},t.prototype.runLogsQuery=function(){return a.b(this,void 0,void 0,function(){var e,t,n,r=this;return a.d(this,function(s){return e=this.queryExpressions.slice(),Object(q.c)(e)?(t=this.state.datasource,n=t.meta.id,e.forEach(function(s,o){return a.b(r,void 0,void 0,function(){var r,i,l,c,u,p;return a.d(this,function(a){switch(a.label){case 0:if(!s)return[3,5];r=this.startQueryTransaction(s,o,"Logs",{format:"logs"}),a.label=1;case 1:return a.trys.push([1,3,,4]),i=Date.now(),[4,t.query(r.options)];case 2:return l=a.sent(),c=Date.now()-i,u=l.data,this.completeQueryTransaction(r.id,u,c,e,n),[3,4];case 3:return p=a.sent(),this.failQueryTransaction(r.id,p,n),[3,4];case 4:return[3,6];case 5:this.discardTransactions(o),a.label=6;case 6:return[2]}})})}),[2]):[2]})})},t.prototype.cloneState=function(){return a.a({},this.state,{queryTransactions:[],queries:Object(q.a)(this.queryExpressions.map(function(e){return{query:e}}))})},t.prototype.render=function(){var e=this.props,t=e.position,n=e.split,a=this.state,r=a.StartPage,o=a.datasource,l=a.datasourceError,u=a.datasourceLoading,p=a.datasourceMissing,m=a.exploreDatasources,h=a.graphRange,d=a.history,f=a.queries,q=a.queryTransactions,O=a.range,R=a.showingGraph,D=a.showingLogs,L=a.showingStartPage,P=a.showingTable,j=a.supportsGraph,_=a.supportsLogs,I=a.supportsTable,M=R&&P?"200px":"400px",G=n?"explore explore-split":"explore",F=o?m.find(function(e){return e.label===o.name}):void 0,A=Q(h,o,this.el?this.el.offsetWidth:0),B=q.some(function(e){return"Graph"===e.resultType&&!e.done}),H=q.some(function(e){return"Table"===e.resultType&&!e.done}),U=q.some(function(e){return"Logs"===e.resultType&&!e.done}),W=c.a.flatten(q.filter(function(e){return"Graph"===e.resultType&&e.done&&e.result}).map(function(e){return e.result})),z=E.b.apply(void 0,[new E.a].concat(q.filter(function(e){return"Table"===e.resultType&&e.done&&e.result}).map(function(e){return e.result}))),Y=o&&o.mergeStreams?o.mergeStreams(c.a.flatten(q.filter(function(e){return"Logs"===e.resultType&&e.done&&e.result}).map(function(e){return e.result})),A.intervalMs):void 0,K=q.some(function(e){return!e.done});return s.a.createElement("div",{className:G,ref:this.getRef},s.a.createElement("div",{className:"navbar"},"left"===t?s.a.createElement("div",null,s.a.createElement("a",{className:"navbar-page-btn"},s.a.createElement("i",{className:"fa fa-rocket"}),"Explore")):s.a.createElement("div",{className:"navbar-buttons explore-first-button"},s.a.createElement("button",{className:"btn navbar-button",onClick:this.onClickCloseSplit},"Close Split")),p?null:s.a.createElement("div",{className:"navbar-buttons"},s.a.createElement(i.b,{classNamePrefix:"gf-form-select-box",isMulti:!1,isLoading:u,isClearable:!1,className:"gf-form-input gf-form-input--form-dropdown datasource-picker",onChange:this.onChangeDatasource,options:m,styles:g.a,placeholder:"Select datasource",loadingMessage:function(){return"Loading datasources..."},noOptionsMessage:function(){return"No datasources found"},value:F,components:{Option:v.a,IndicatorsContainer:y.a,NoOptionsMessage:b.a}})),s.a.createElement("div",{className:"navbar__spacer"}),"left"!==t||n?null:s.a.createElement("div",{className:"navbar-buttons"},s.a.createElement("button",{className:"btn navbar-button",onClick:this.onClickSplit},"Split")),s.a.createElement(N.a,{range:O,onChangeTime:this.onChangeTime}),s.a.createElement("div",{className:"navbar-buttons"},s.a.createElement("button",{className:"btn navbar-button navbar-button--no-icon",onClick:this.onClickClear},"Clear All")),s.a.createElement("div",{className:"navbar-buttons relative"},s.a.createElement("button",{className:"btn navbar-button--primary",onClick:this.onSubmit},"Run Query"," ",K?s.a.createElement("i",{className:"fa fa-spinner fa-spin run-icon"}):s.a.createElement("i",{className:"fa fa-level-down run-icon"})))),u?s.a.createElement("div",{className:"explore-container"},"Loading datasource..."):null,p?s.a.createElement("div",{className:"explore-container"},"Please add a datasource that supports Explore (e.g., Prometheus)."):null,l?s.a.createElement("div",{className:"explore-container"},"Error connecting to datasource. [",l,"]"):null,o&&!l?s.a.createElement("div",{className:"explore-container"},s.a.createElement(C.a,{datasource:o,history:d,queries:f,onAddQueryRow:this.onAddQueryRow,onChangeQuery:this.onChangeQuery,onClickHintFix:this.onModifyQueries,onExecuteQuery:this.onSubmit,onRemoveQueryRow:this.onRemoveQueryRow,transactions:q}),s.a.createElement("main",{className:"m-t-2"},s.a.createElement(k.a,null,L&&s.a.createElement(r,{onClickQuery:this.onClickQuery}),!L&&s.a.createElement(s.a.Fragment,null,j&&s.a.createElement(w.a,{label:"Graph",isOpen:R,loading:B,onToggle:this.onClickGraphButton},s.a.createElement(S.a,{data:W,height:M,id:"explore-graph-"+t,onChangeTime:this.onChangeTime,range:h,split:n})),I&&s.a.createElement(w.a,{label:"Table",loading:H,isOpen:P,onToggle:this.onClickTableButton},s.a.createElement(T.a,{data:z,loading:H,onClickCell:this.onClickTableCell})),_&&s.a.createElement(w.a,{label:"Logs",loading:U,isOpen:D,onToggle:this.onClickLogsButton},s.a.createElement(x.a,{data:Y,loading:U,position:t,onChangeTime:this.onChangeTime,range:O})))))):null)},t}(s.a.PureComponent);t.a=Object(o.hot)(e)(R)}).call(this,n(66)(e))},1369:function(e,t,n){"use strict";var a=n(2),r=n(0),s=n.n(r),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickToggle=function(){return t.props.onToggle(!t.props.isOpen)},t}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.isOpen,n=e.loading,a=t?"fa fa-caret-up":"fa fa-caret-down",r=n?"explore-panel__loader explore-panel__loader--active":"explore-panel__loader";return s.a.createElement("div",{className:"explore-panel panel-container"},s.a.createElement("div",{className:"explore-panel__header",onClick:this.onClickToggle},s.a.createElement("div",{className:"explore-panel__header-buttons"},s.a.createElement("span",{className:a})),s.a.createElement("div",{className:"explore-panel__header-label"},this.props.label)),t&&s.a.createElement("div",{className:"explore-panel__body"},s.a.createElement("div",{className:r}),this.props.children))},t}(r.PureComponent);t.a=o},1370:function(e,t,n){"use strict";var a=n(2),r=n(1),s=n.n(r),o=n(0),i=n.n(o),l=n(1365),c=new(n(73).a),u=/^[Vv]alue #\d+/;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getCellProps=function(e,n,a){return{onClick:function(e){if(e.target&&"link"===e.target.className){var r=a.Header,s=n.row[r];t.props.onClickCell(r,s)}}}},t}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.data,n=e.loading,a=t||c,r=a.columns.map(function(e){return e.text}),o=a.columns.map(function(e){var t=e.filterable,n=e.text;return{Header:n,accessor:n,className:u.test(n)?"text-right":"",show:"Time"!==n,Cell:function(e){return i.a.createElement("span",{className:t?"link":""},e.value)}}}),p=t?"The queries returned no data for a table.":"";return i.a.createElement(l.a,{columns:o,data:a.rows,getTdProps:this.getCellProps,loading:n,minRows:0,noDataText:p,resolveData:function(e){return function(e,t){return e.map(function(e){return s.a.zipObject(t,e)})}(e,r)},showPagination:Boolean(t)})},t}(o.PureComponent);t.a=p},1371:function(e,t,n){"use strict";var a=n(2),r=n(0),s=n.n(r),o=n(4),i=n.n(o),l=n(27),c=n(114),u="YYYY-MM-DD HH:mm:ss",p={from:"now-6h",to:"now"};function m(e,t){if(void 0===t&&(t=!1),i.a.isMoment(e))return e;if(-1!==e.indexOf("now"))return e;var n=e;return isNaN(n)||(n=parseInt(n,10)),(n=t?i.a.utc(n):i()(n)).format(u)}var h=function(e){function t(t){var n=e.call(this,t)||this;return n.handleChangeFrom=function(e){n.setState({fromRaw:e.target.value})},n.handleChangeTo=function(e){n.setState({toRaw:e.target.value})},n.handleClickApply=function(){var e,t=n.props.onChangeTime;n.setState(function(t){var a=n.state,r=a.toRaw,s=a.fromRaw;return e={from:l.parse(s,!1),to:l.parse(r,!0)},{isOpen:!1,rangeString:c.b(e)}},function(){t&&t(e)})},n.handleClickLeft=function(){return n.move(-1)},n.handleClickPicker=function(){n.setState(function(e){return{isOpen:!e.isOpen}})},n.handleClickRight=function(){return n.move(1)},n.handleClickRefresh=function(){},n.handleClickRelativeOption=function(e){var t=n.props.onChangeTime,a=c.b(e);n.setState({toRaw:e.to,fromRaw:e.from,isOpen:!1,rangeString:a},function(){t&&t(e)})},n.dropdownRef=function(e){n.dropdownEl=e},n.state={isOpen:t.isOpen,isUtc:t.isUtc,rangeString:"",fromRaw:"",toRaw:"",initialRange:p,refreshInterval:""},n}return a.c(t,e),t.getDerivedStateFromProps=function(e,t){if(t.initialRange&&t.initialRange===e.range)return t;var n=e.range?e.range.from:p.from,r=e.range?e.range.to:p.to,s=m(n,e.isUtc),o=m(r,e.isUtc),i={from:s,to:o};return a.a({},t,{fromRaw:s,toRaw:o,initialRange:e.range,rangeString:c.b(i)})},t.prototype.move=function(e){var t,n,a=this.props.onChangeTime,r=this.state,s=r.fromRaw,o=r.toRaw,p=l.parse(s,!1),m=l.parse(o,!0),h=(m.valueOf()-p.valueOf())/2;-1===e?(t=m.valueOf()-h,n=p.valueOf()-h):1===e?(t=m.valueOf()+h,n=p.valueOf()+h,t>Date.now()&&m<Date.now()&&(t=Date.now(),n=p.valueOf())):(t=m.valueOf(),n=p.valueOf());var d={from:i()(n),to:i()(t)};this.setState({rangeString:c.b(d),fromRaw:d.from.format(u),toRaw:d.to.format(u)},function(){a(d)})},t.prototype.getTimeOptions=function(){return c.c({},this.state.rangeString)},t.prototype.renderDropdown=function(){var e=this,t=this.state,n=t.fromRaw,a=t.isOpen,r=t.toRaw;if(!a)return null;var o=this.getTimeOptions();return s.a.createElement("div",{ref:this.dropdownRef,className:"gf-timepicker-dropdown"},s.a.createElement("div",{className:"gf-timepicker-absolute-section"},s.a.createElement("h3",{className:"section-heading"},"Custom range"),s.a.createElement("label",{className:"small"},"From:"),s.a.createElement("div",{className:"gf-form-inline"},s.a.createElement("div",{className:"gf-form max-width-28"},s.a.createElement("input",{type:"text",className:"gf-form-input input-large timepicker-from",value:n,onChange:this.handleChangeFrom}))),s.a.createElement("label",{className:"small"},"To:"),s.a.createElement("div",{className:"gf-form-inline"},s.a.createElement("div",{className:"gf-form max-width-28"},s.a.createElement("input",{type:"text",className:"gf-form-input input-large timepicker-to",value:r,onChange:this.handleChangeTo}))),s.a.createElement("div",{className:"gf-form"},s.a.createElement("button",{className:"btn gf-form-btn btn-secondary",onClick:this.handleClickApply},"Apply"))),s.a.createElement("div",{className:"gf-timepicker-relative-section"},s.a.createElement("h3",{className:"section-heading"},"Quick ranges"),Object.keys(o).map(function(t){var n=o[t];return s.a.createElement("ul",{key:t},n.map(function(t){return s.a.createElement("li",{className:t.active?"active":"",key:t.display},s.a.createElement("a",{onClick:function(){return e.handleClickRelativeOption(t)}},t.display))}))})))},t.prototype.render=function(){var e=this.state,t=e.isUtc,n=e.rangeString,a=e.refreshInterval;return s.a.createElement("div",{className:"timepicker"},s.a.createElement("div",{className:"navbar-buttons"},s.a.createElement("button",{className:"btn navbar-button navbar-button--tight timepicker-left",onClick:this.handleClickLeft},s.a.createElement("i",{className:"fa fa-chevron-left"})),s.a.createElement("button",{className:"btn navbar-button gf-timepicker-nav-btn",onClick:this.handleClickPicker},s.a.createElement("i",{className:"fa fa-clock-o"}),s.a.createElement("span",{className:"timepicker-rangestring"},n),t?s.a.createElement("span",{className:"gf-timepicker-utc"},"UTC"):null,a?s.a.createElement("span",{className:"text-warning"},"Â  Refresh every ",a):null),s.a.createElement("button",{className:"btn navbar-button navbar-button--tight timepicker-right",onClick:this.handleClickRight},s.a.createElement("i",{className:"fa fa-chevron-right"}))),this.renderDropdown())},t}(r.PureComponent);t.a=h},1372:function(e,t,n){"use strict";function a(e){return void 0===e&&(e=0),"Q-"+Date.now()+"-"+Math.random()+"-"+e}function r(e){return e&&"object"==typeof e&&e.length>0&&"string"==typeof e[0].query?e.map(function(e,t){var n=e.query;return{key:a(t),query:n}}):[{key:a(),query:""}]}function s(e){return e.some(function(e){return Boolean(e)})}n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r}),n.d(t,"c",function(){return s})},1373:function(e,t,n){"use strict";var a=n(2),r=n(0),s=n.n(r),o=n(242),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={elapsed:0},t.tick=function(){var e=Date.now()-t.offset;t.setState({elapsed:e})},t}return a.c(t,e),t.prototype.start=function(){this.offset=Date.now(),this.timer=window.setInterval(this.tick,150)},t.prototype.componentWillReceiveProps=function(e){e.time?clearInterval(this.timer):this.props.time&&this.start()},t.prototype.componentDidMount=function(){this.start()},t.prototype.componentWillUnmount=function(){clearInterval(this.timer)},t.prototype.render=function(){var e=this.state.elapsed,t=this.props,n=t.className,a=(t.time||e)/1e3;return s.a.createElement("span",{className:"elapsed-time "+n},a.toFixed(1),"s")},t}(r.PureComponent);var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props.transaction,t=e.done?"query-transaction":"query-transaction query-transaction--loading";return s.a.createElement("div",{className:t},s.a.createElement("div",{className:"query-transaction__type"},e.resultType,":"),s.a.createElement("div",{className:"query-transaction__duration"},e.done?function(e){return(e/1e3).toFixed(1)+"s"}(e.latency):s.a.createElement(i,null)))},t}(r.PureComponent),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props.transactions;return s.a.createElement("div",{className:"query-transactions"},e.map(function(e,t){return s.a.createElement(l,{key:e.query+":"+e.resultType,transaction:e})}))},t}(r.PureComponent);var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChangeQuery=function(e,n){var a=t.props,r=a.index,s=a.onChangeQuery;s&&s(e,r,n)},t.onClickAddButton=function(){var e=t.props,n=e.index,a=e.onAddQueryRow;a&&a(n)},t.onClickClearButton=function(){t.onChangeQuery("",!0)},t.onClickHintFix=function(e){var n=t.props,a=n.index,r=n.onClickHintFix;r&&r(e,a)},t.onClickRemoveButton=function(){var e=t.props,n=e.index,a=e.onRemoveQueryRow;a&&a(n)},t.onPressEnter=function(){var e=t.props.onExecuteQuery;e&&e()},t}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.datasource,n=e.history,a=e.query,r=e.transactions,i=r.find(function(e){return void 0!==e.error}),l=function(e){var t=e.find(function(e){return e.hints&&e.hints.length>0});if(t)return t.hints[0]}(r),u=i?i.error:null,p=t.pluginExports.ExploreQueryField||o.a;return s.a.createElement("div",{className:"query-row"},s.a.createElement("div",{className:"query-row-status"},s.a.createElement(c,{transactions:r})),s.a.createElement("div",{className:"query-row-field"},s.a.createElement(p,{datasource:t,error:u,hint:l,initialQuery:a,history:n,onClickHintFix:this.onClickHintFix,onPressEnter:this.onPressEnter,onQueryChange:this.onChangeQuery})),s.a.createElement("div",{className:"query-row-tools"},s.a.createElement("button",{className:"btn navbar-button navbar-button--tight",onClick:this.onClickClearButton},s.a.createElement("i",{className:"fa fa-times"})),s.a.createElement("button",{className:"btn navbar-button navbar-button--tight",onClick:this.onClickAddButton},s.a.createElement("i",{className:"fa fa-plus"})),s.a.createElement("button",{className:"btn navbar-button navbar-button--tight",onClick:this.onClickRemoveButton},s.a.createElement("i",{className:"fa fa-minus"}))))},t}(r.PureComponent),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.c(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,r=e.queries,o=e.transactions,i=a.e(e,["className","queries","transactions"]);return s.a.createElement("div",{className:n},r.map(function(e,t){return s.a.createElement(u,a.a({key:e.key,index:t,query:e.query,transactions:o.filter(function(e){return e.rowIndex===t})},i))}))},t}(r.PureComponent);t.a=p},1374:function(e,t,n){"use strict";var a=n(2),r=n(0),s=n.n(r),o=n(166),i=n.n(o),l=n(142);function c(e){var t=e.searchWords;return function(e,t){if(!e||!t)return[];var n=new RegExp("(?:"+t+")","g"),a=[],r=n.exec(e);for(;r;)a.push({text:r[0],start:r.index,length:r[0].length,end:r.index+r[0].length}),r=n.exec(e);return a}(e.textToHighlight,t.join(" "))}var u=n(253),p=n(1367),m={series:{bars:{show:!0,lineWidth:5}},yaxis:{tickDecimals:0}},h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={dedup:l.b.none,showLabels:!0,showLocalTime:!0,showUtc:!1},t.onChangeDedup=function(e){t.setState(function(t){return t.dedup===e?{dedup:l.b.none}:{dedup:e}})},t.onChangeLabels=function(e){var n=e.target;t.setState({showLabels:n.checked})},t.onChangeLocalTime=function(e){var n=e.target;t.setState({showLocalTime:n.checked})},t.onChangeUtc=function(e){var n=e.target;t.setState({showUtc:n.checked})},t}return a.c(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.className,a=void 0===n?"":n,o=t.data,h=t.loading,d=void 0!==h&&h,f=t.position,g=t.range,v=this.state,y=v.dedup,b=v.showLabels,E=v.showLocalTime,w=v.showUtc,C=o&&o.rows&&o.rows.length>0,S=Object(l.c)(o,y),x=S.rows.reduce(function(e,t){return e+t.duplicates},0),T=o.meta.slice();y!==l.b.none&&T.push({label:"Dedup count",value:String(x)});var k=["3px"];w&&k.push("minmax(100px, max-content)"),E&&k.push("minmax(100px, max-content)"),b&&k.push("minmax(100px, 25%)"),k.push("1fr");var N={gridTemplateColumns:k.join(" ")};return s.a.createElement("div",{className:a+" logs"},s.a.createElement("div",{className:"logs-graph"},s.a.createElement(p.a,{data:o.series,height:"100px",range:g,id:"explore-logs-graph-"+f,onChangeTime:this.props.onChangeTime,userOptions:m})),s.a.createElement("div",{className:"logs-options"},s.a.createElement("div",{className:"logs-controls"},s.a.createElement(u.a,{label:"Timestamp",checked:w,onChange:this.onChangeUtc,small:!0}),s.a.createElement(u.a,{label:"Local time",checked:E,onChange:this.onChangeLocalTime,small:!0}),s.a.createElement(u.a,{label:"Labels",checked:b,onChange:this.onChangeLabels,small:!0}),s.a.createElement(u.a,{label:"Dedup: off",checked:y===l.b.none,onChange:function(){return e.onChangeDedup(l.b.none)},small:!0}),s.a.createElement(u.a,{label:"Dedup: exact",checked:y===l.b.exact,onChange:function(){return e.onChangeDedup(l.b.exact)},small:!0}),s.a.createElement(u.a,{label:"Dedup: numbers",checked:y===l.b.numbers,onChange:function(){return e.onChangeDedup(l.b.numbers)},small:!0}),s.a.createElement(u.a,{label:"Dedup: signature",checked:y===l.b.signature,onChange:function(){return e.onChangeDedup(l.b.signature)},small:!0}),C&&T&&s.a.createElement("div",{className:"logs-meta"},T.map(function(e){return s.a.createElement("div",{className:"logs-meta-item",key:e.label},s.a.createElement("span",{className:"logs-meta-item__label"},e.label,":"),s.a.createElement("span",{className:"logs-meta-item__value"},e.value))})))),s.a.createElement("div",{className:"logs-entries",style:N},C&&S.rows.map(function(e){return s.a.createElement(r.Fragment,{key:e.key},s.a.createElement("div",{className:e.logLevel?"logs-row-level logs-row-level-"+e.logLevel:""},e.duplicates>0&&s.a.createElement("div",{className:"logs-row-level__duplicates",title:e.duplicates+" duplicates"},Array.apply(null,{length:e.duplicates}).map(function(e){return s.a.createElement("div",{className:"logs-row-level__duplicate",key:""+e})}))),w&&s.a.createElement("div",{title:"Local: "+e.timeLocal+" ("+e.timeFromNow+")"},e.timestamp),E&&s.a.createElement("div",{title:e.timestamp+" ("+e.timeFromNow+")"},e.timeLocal),b&&s.a.createElement("div",{className:"max-width",title:e.labels},e.labels),s.a.createElement("div",null,s.a.createElement(i.a,{textToHighlight:e.entry,searchWords:e.searchWords,findChunks:c,highlightClassName:"logs-row-match-highlight"})))})),!d&&!C&&"No data was returned.")},t}(r.PureComponent);t.a=h},1375:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"Wrapper",function(){return h});var a=n(2),r=n(0),s=n.n(r),o=n(35),i=n(21),l=n(44),c=n(210),u=n(1366),p=n(1368),m="stateRight",h=function(e){function t(t){var n=e.call(this,t)||this;return n.onChangeSplit=function(e,t){n.setState({split:e,splitState:t}),e||(delete n.urlStates[m],n.props.updateLocation({query:n.urlStates}))},n.onSaveState=function(e,t){var a=Object(c.d)(t,!0);n.urlStates[e]=a,n.props.updateLocation({query:n.urlStates})},n.urlStates=t.urlStates,n.state={split:Boolean(t.urlStates[m]),splitState:void 0},n}return a.c(t,e),t.prototype.render=function(){var e=this.props.datasourceSrv,t=this.state,n=t.split,a=t.splitState,r=Object(c.c)(this.urlStates.state),o=Object(c.c)(this.urlStates[m]);return s.a.createElement("div",{className:"explore-wrapper"},s.a.createElement(u.a,null,s.a.createElement(p.a,{datasourceSrv:e,onChangeSplit:this.onChangeSplit,onSaveState:this.onSaveState,position:"left",split:n,stateKey:"state",urlState:r})),n&&s.a.createElement(u.a,null,s.a.createElement(p.a,{datasourceSrv:e,onChangeSplit:this.onChangeSplit,onSaveState:this.onSaveState,position:"right",split:n,splitState:a,stateKey:m,urlState:o})))},t}(r.Component),d={updateLocation:l.c};t.default=Object(o.hot)(e)(Object(i.b)(function(e){return{urlStates:e.location.query}},d)(h))}.call(this,n(66)(e))}}]);
//# sourceMappingURL=explore.469095018b321ef1da7c.js.map